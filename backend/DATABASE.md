# База данных Persona News

## Описание

Проект использует SQLite базу данных для хранения пользователей и их обратной связи (лайки, дизлайки, скрытые статьи).

## Структура базы данных

### Таблица `users`
- `id` (PK) - уникальный идентификатор
- `user_id` (String, уникальный, индексированный) - ID пользователя
- `created_at` - дата создания
- `updated_at` - дата последнего обновления
- `preferred_topics` (JSON) - предпочтительные темы пользователя
- `preferred_sources` (JSON) - предпочтительные источники

### Таблица `user_feedback`
- `id` (PK) - уникальный идентификатор
- `user_id` (FK → users.user_id) - ID пользователя
- `article_id` (Integer, индексированный) - ID статьи
- `action` (String) - действие: "like", "dislike", "hide"
- `created_at` - дата создания
- `expires_at` - дата истечения (для скрытых статей, через 1 час)

## Инициализация

База данных автоматически инициализируется при старте приложения через `@app.on_event("startup")`.

Также можно инициализировать вручную:
```bash
cd backend
python init_db.py
```

## Использование

Все данные пользователей теперь сохраняются в БД и не теряются при перезапуске сервера.

### Примеры работы:

1. **Создание пользователя** - происходит автоматически при первом обращении
2. **Сохранение лайков/дизлайков** - сохраняется в таблице `user_feedback`
3. **Скрытие статей** - сохраняется с автоматическим истечением через 1 час
4. **Получение данных** - все данные читаются из БД

## Файл базы данных

База данных создается в файле `backend/news.db` (SQLite).

Файл добавлен в `.gitignore` и не попадает в репозиторий.

